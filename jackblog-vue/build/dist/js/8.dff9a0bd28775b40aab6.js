webpackJsonp([8],{"8BA9":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=e("WMGj"),i=e.n(n),s=e("Lj8P");var r=function(t){e("DLjK")},l=e("J0+h")(i.a,s.a,r,null,null);a.default=l.exports},DLjK:function(t,a,e){var n=e("YlSU");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);e("FIqI")("c3c10ebe",n,!0,{})},Lj8P:function(t,a,e){"use strict";var n={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"settings-box"},[e("div",{staticClass:"setting-nav"},[e("ul",{staticClass:"nav nav-pills nav-stacked"},t._l(t.settings,function(a,n){return e("li",{key:n,class:{active:n==t.navIndex},on:{click:function(a){return t.setActive(n)}}},[e("a",[e("span",{staticClass:"glyphicon glyphicon-th-list",attrs:{"aria-hidden":"true"}}),t._v("\n          "+t._s(a.title))])])}),0)]),t._v(" "),e("div",{staticClass:"settings-container"},[e("div",{staticClass:"settings-content",class:{active:0==t.navIndex}},[e("form",{staticClass:"form-horizontal",attrs:{novalidate:""},on:{submit:function(a){return a.preventDefault(),t.mdUser()}}},[e("div",{staticClass:"form-group"},[e("a",{staticClass:"col-sm-4",attrs:{title:t.nickname}},[e("canvas",{ref:"cutCanvas",staticClass:"setting-avatar",attrs:{id:"canvascontainer"}},[t._v("\n              您的浏览器不支持canvas，请升级最新版本\n            ")])]),t._v(" "),e("a",{staticClass:"col-sm-2 btn setting-btn"},[e("input",{staticClass:"file-input",attrs:{type:"file",name:"newAvatar",accept:"image/gif,image/jpeg,image/jpg,image/png"},on:{change:function(a){return t.changeAvatar(a)}}}),t._v(" "),e("span",{staticClass:"file-input-span"},[t._v("修改头像")])])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"col-sm-4 control-label"},[t._v("昵称")]),t._v(" "),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.user.nickname,expression:"user.nickname"}],staticClass:"form-control",attrs:{type:"text",name:"nickname",placeholder:"2-15字符，中英文、数字和下划线"},domProps:{value:t.user.nickname},on:{input:function(a){a.target.composing||t.$set(t.user,"nickname",a.target.value)}}})])]),t._v(" "),e("hr"),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"col-sm-4 control-label"},[t._v("邮箱")]),t._v(" "),e("div",{staticClass:"col-sm-8"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.user.email,expression:"user.email"},{name:"validate",rawName:"v-validate"}],staticClass:"form-control",attrs:{type:"text",name:"email",placeholder:""},domProps:{value:t.user.email},on:{input:function(a){a.target.composing||t.$set(t.user,"email",a.target.value)}}})])]),t._v(" "),e("div",{staticClass:"form-group"}),t._v(" "),e("div",{staticClass:"form-group"}),t._v(" "),t._m(0)])]),t._v(" "),e("div",{staticClass:"settings-content",class:{active:1==t.navIndex}},[t._m(1)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-sm-4"},[a("button",{staticClass:"btn btn-block btn-lg btn-primary",attrs:{type:"submit"}},[this._v("保 存")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("ul",[a("li",[this._v("待开发")])])}]};a.a=n},WMGj:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=s(e("4YfN")),i=e("SJI6");e("YClM"),s(e("0gU3"));function s(t){return t&&t.__esModule?t:{default:t}}a.default={data:function(){return{navIndex:0,settings:[{title:"基本设置"},{title:"其他设置"}],newAvatar:"",cutCanvas:null,cutCtx:null,originCanvas:null,originCtx:null}},computed:(0,n.default)({},(0,i.mapState)({nickname:function(t){var a=t.auth;return a.user&&a.user.nickname},avatar:function(t){var a=t.auth;return a.user&&a.user.avatar},email:function(t){var a=t.auth;return a.user&&a.user.email}}),{user:{get:function(){return{nickname:this.nickname,avatar:this.avatar,email:this.email}},set:function(){return{nickname:value,email:value}}}}),created:function(){this.getUserInfo()},methods:(0,n.default)({},(0,i.mapActions)(["updateUser","getUserInfo","showMsg"]),{mdUser:function(){var t=this;this.$validator.validateAll().then(function(a){a?(console.log(t.user),t.updateUser(t.user)):t.showMsg("请正确填写内容","info")})},setActive:function(t){this.navIndex=t},changeAvatar:function(t){var a=this,e=t.target.files[0];e&&this.changeDataURL(e,function(t){var e=new Image;e.src=t,a.cutCtx.clearRect(0,0,120,120),e.onload=function(){var t=0,n=0,i=0,s=0;e.width>=e.height?(s=120,t=((i=e.width/e.height*120==0?e.width:e.width/e.height*120)-s)/-2):(i=120,n=((s=e.height/e.width*120)-i)/-2),a.cutCtx.drawImage(e,t,n,i,s),a.user.avatar=a.cutCanvas.toDataURL("image/jpeg",.92)}})},clearCanvas:function(){this.cutCtx.clearRect(0,0,120,120)},changeDataURL:function(t,a){var e=new FileReader;e.readAsDataURL(t),e.onload=function(t){a(t.target.result)}}}),mounted:function(){var t=this,a=this.cutCanvas=this.$refs.cutCanvas;if(this.cutCtx=a.getContext("2d"),a.width=120,a.height=120,a.getContext){var e=new Image;e.src=this.user.avatar,e.onload=function(){t.cutCtx.drawImage(e,0,0,120,120)}}}}},YlSU:function(t,a,e){(t.exports=e("UTlt")(!1)).push([t.i,".setting-avatar{border-radius:50%}.form-horizontal .form-group{margin-right:15px;margin-left:15px}.form-horizontal .control-label{text-align:left}.btn.setting-btn{min-width:80px;border-radius:20px;outline:none;margin-top:35px;background-color:#fff;border-color:#05c1f0;color:#05c1f0;height:40px;margin-left:15px}.btn.setting-btn:focus{outline:none}.file-input{z-index:1000;opacity:0}.file-input,.file-input-span{position:absolute;width:100%;height:100%;left:0;top:0}.file-input-span{z-index:100;margin-top:10px}",""])}});
//# sourceMappingURL=8.dff9a0bd28775b40aab6.js.map